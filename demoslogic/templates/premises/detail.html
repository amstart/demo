{% extends "premises/base.html" %}

{% load crispy_forms_tags %}
{% load static %}
{% load i18n %}
{% load premises %}
{% load blockobjects %}

{% block head_title %}{{ premise }}{% endblock %}
{% block inner %}
  <link rel="stylesheet" type="text/css" href="{% static 'premises/style.css' %}" />
  <div class="row">
    <h1> {% premise_print_with_class premise %} </h1>
  </div>
  {% if user_choice or request.user == premise.user %}
    <a class="link_created_by" href="{% url 'users:detail' premise.user.username %}">
      <small>created by</small> {{ premise.user.username }}
    </a>
    <h4> Votes </h4>
    <div class="chart"></div>
    <br>
  {% endif %}
  {% if not user_choice %}
    {% crispy voteform voteform.helper %}
  {% endif %}
  <div class="row">
    {% if user_choice %}
      <div class="col-md-2">
          <a href="{% url 'premises:update_vote' premise.id %}" class="btn btn-secondary">
            edit vote
          </a>
      </div>
    {% endif %}
    {% if request.user == premise.user and not premise.staged %}
      <div class="col-md-2">
        <a href="{% url 'premises:delete' premise.id %}" class="btn btn-secondary" id='id_delete'>
          delete premise
        </a>
      </div>
    {% endif %}
  </div>
{% endblock %}

{% block javascript %}
  {{ block.super }}
  <script>
    barplot({{ plot_data }}, {{ plot_labels|jsonify }}, {{ user_choice }});
  </script>
{% endblock %}
